DROP TABLE IF EXISTS MPA CASCADE;
DROP TABLE IF EXISTS FILMS CASCADE;
DROP TABLE IF EXISTS HALLS CASCADE;
DROP TABLE IF EXISTS SESSIONS;

CREATE TABLE MPA (
    mpa_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    category VARCHAR(20) NOT NULL
);

CREATE TABLE FILMS (
    film_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    name VARCHAR(255) NOT NULL,
    description VARCHAR(200),
    release_date DATE NOT NULL,
    duration INT NOT NULL,
    mpa_id INT NOT NULL,
    FOREIGN KEY (mpa_id) REFERENCES MPA
);

CREATE TABLE HALLS (
    hall_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    title VARCHAR(20) NOT NULL,
    capacity INT
);

CREATE TABLE SESSIONS (
    cost INT NOT NULL,
    show_time DATE NOT NULL,
    film_id INT NOT NULL,
    hall_id INT NOT NULL,
    FOREIGN KEY (film_id) REFERENCES FILMS ON DELETE CASCADE,
    FOREIGN KEY (hall_id) REFERENCES HALLS ON DELETE CASCADE
);

CREATE TABLE USERS (
    user_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    name VARCHAR(200) NOT NULL,
    email VARCHAR(200) NOT NULL,
    login VARCHAR(200) NOT NULL,
    birthday DATE NOT NULL
);